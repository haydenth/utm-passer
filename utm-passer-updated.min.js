function getUrlParams(t){let r={},e=t;(e=e||window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,n){r[e]=n});return r}function getUrlParam(t){var e=getUrlParams();return e&&e[t]?e[t]:null}function overwriteOutgoingLinks(e,n,r,i,m){var u,a=document.getElementsByTagName("a");for(u in a){var o=a[u].href,s=getUrlParams(o);e&&(s.utm_source=e),n&&(s.utm_medium=n),r&&(s.utm_campaign=r),i&&(s.utm_content=i),m&&(s.utm_term=m);let t=!0;if(!1===(t=void 0!==a[u].getAttribute?null!==a[u].getAttribute("no-utm"):t)&&o&&""!=o){let t=o.substring(o.indexOf("?")+1),e=(0<o.indexOf("?")&&(t=o.substring(0,o.indexOf("?"))),""),n=(0<o.indexOf("#")&&(e=o.substring(o.indexOf("#"))),Object.entries(s));o=(n=n.map(([t,e])=>encodeURIComponent(t)+"="+encodeURIComponent(e))).join("&");a[u].href=t+"?"+o+e}}}function overwriteIframeSrcs(i,m,u,a,o){var s=document.getElementsByTagName("iframe");for(let r=0;r<s.length;r++){var c=s[r].src;let t=!1;if(!(t=void 0!==s[r].getAttribute?null!==s[r].getAttribute("no-utm"):t)&&c&&""!==c&&(!c.startsWith("data:")&&!c.startsWith("blob:")&&(c.includes("://")||c.startsWith("//")))){var d=getUrlParams(c);i&&(d.utm_source=i),m&&(d.utm_medium=m),u&&(d.utm_campaign=u),a&&(d.utm_content=a),o&&(d.utm_term=o);let t=c,e=(0<c.indexOf("?")&&(t=c.substring(0,c.indexOf("?"))),""),n=(0<c.indexOf("#")&&(e=c.substring(c.indexOf("#")),0<t.indexOf("#"))&&(t=t.substring(0,t.indexOf("#"))),Object.entries(d));c=(n=n.map(([t,e])=>encodeURIComponent(t)+"="+encodeURIComponent(e))).join("&"),d=t+"?"+c+e;s[r].src=d}}}async function utmOverwrite(){var t=getUrlParam("utm_source"),e=getUrlParam("utm_medium"),n=getUrlParam("utm_campaign"),r=getUrlParam("utm_content"),i=getUrlParam("utm_term");(t||e||n||r||i)&&(console.log("utm-passer: overwriting outbound links and iframes..."),overwriteOutgoingLinks(t,e,n,r,i),overwriteIframeSrcs(t,e,n,r,i))}document.addEventListener("DOMContentLoaded",utmOverwrite),document.addEventListener("click",utmOverwrite),document.addEventListener("click",function(){setTimeout(utmOverwrite,1500)});
